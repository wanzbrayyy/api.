<!DOCTYPE html>
<html lang="en">
<%- include('partials/head') %>
<body>
    <%- include('partials/navbar', { user: user }) %>

    <div class="main-wrapper container animate__animated animate__fadeIn">
        <div class="glass-panel profile-card">
            <div style="text-align: center; margin-bottom: 30px;">
                <img src="<%= user.avatar %>" class="profile-avatar">
                <h2 style="margin: 0;"><%= user.name %></h2>
                <p style="color: #94a3b8;"><%= user.email %></p>
            </div>

            <div style="background: rgba(0,0,0,0.2); padding: 20px; border-radius: 12px; margin-bottom: 30px; border: 1px solid var(--glass-border);">
                <label style="color: #facc15; font-weight: 600; display: block; margin-bottom: 10px;">
                    <i class="fa-solid fa-key"></i> your api key
                </label>
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <input type="text" value="<%= user.apiKey ? user.apiKey : 'No API Key Generated' %>" readonly class="input-modern" style="font-family: monospace; color: #818cf8;">
                    <button onclick="navigator.clipboard.writeText('<%= user.apiKey %>')" class="btn-modern" style="padding: 0 15px;" title="Copy">
                        <i class="fa-regular fa-copy"></i>
                    </button>
                </div>
                <form action="/api/user/generate-key" method="POST">
                    <button type="submit" class="btn-modern" style="width: 100%; background: var(--secondary);">
                        <%= user.apiKey ? 'Regenerate API Key' : 'Generate API Key' %>
                    </button>
                </form>
                <p style="font-size: 0.8rem; color: #94a3b8; margin-top: 10px;">
                    *Use this key to access scraping endpoints. Keep it secret!
                </p>
            </div>

            <form action="/api/user/profile" method="POST" enctype="multipart/form-data">
                <h3 style="margin-bottom: 20px; font-size: 1.2rem;">Edit Profile</h3>
                <div style="margin-bottom: 20px;">
                    <div class="input-group">
                        <i class="fa-solid fa-user-pen input-icon"></i>
                        <input type="text" name="name" value="<%= user.name %>" class="input-modern">
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <div class="input-group">
                        <i class="fa-solid fa-image input-icon"></i>
                        <input type="file" name="avatar" class="input-modern" style="padding: 10px 10px 10px 45px;">
                    </div>
                </div>

                <button type="submit" class="btn-primary">Save Changes</button>
            </form>
        </div>
    </div>
</body>
</html>