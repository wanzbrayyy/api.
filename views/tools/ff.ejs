<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head') %>
<body>
    <%- include('../partials/navbar', { user: user }) %>
    <div class="main-wrapper container animate__animated animate__fadeIn">
        <div class="glass-panel" style="max-width: 800px; margin: 0 auto; padding: 30px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0; color: #ef4444;"><i class="fa-solid fa-fire"></i> FF API Tester</h2>
                <span class="status-badge" id="statusCode">READY</span>
            </div>

            <div class="input-group">
                <span style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 5px; display: block;">Endpoint: POST /api/tools/ff</span>
                <input type="text" id="param" class="input-modern" placeholder="Player ID (e.g 123456)">
            </div>
            
            <button onclick="fetchApi()" class="btn-modern" style="width: 100%; margin-top: 15px; background: #ef4444;">POST Request</button>

            <div class="response-container" style="margin-top: 30px;">
                <strong style="color: #cbd5e1;">Response Body (JSON)</strong>
                <pre id="jsonOutput" style="background: #0f172a; padding: 20px; border-radius: 10px; overflow-x: auto; color: #a5b4fc; margin-top: 10px;">// Waiting...</pre>
            </div>
        </div>
    </div>

    <script>
        const userApiKey = "<%= user.apiKey || '' %>";
        async function fetchApi() {
            const param = document.getElementById('param').value;
            if(!userApiKey) return alert("API Key Required!");

            document.getElementById('statusCode').innerText = "POSTING...";
            
            // Perhatikan pemanggilan API Key via Query Param meskipun Method POST
            const req = await fetch(`/api/tools/ff?apikey=${userApiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id: param })
            });
            const data = await req.json();
            
            document.getElementById('statusCode').innerText = req.status;
            document.getElementById('statusCode').style.background = req.ok ? "#22c55e" : "#ef4444";
            document.getElementById('jsonOutput').innerText = JSON.stringify(data, null, 4);
        }
    </script>
    <style>.status-badge{background:#64748b;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px;}</style>
</body>
</html>